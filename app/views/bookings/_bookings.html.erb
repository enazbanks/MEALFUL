<div>
  <ul>
    <% can_delete = true %>
    <% meal.bookings.each do |booking|%>
        <li>
          <%= "#{booking.user.first_name} is booked in for #{booking.date}" %>
          <%= "with #{booking.size}" %> <i class="fa-solid fa-people-group"></i>
          <%= "Total cost $#{booking.price}" %>
        </li>
        <%= turbo_frame_tag dom_id(booking) do %>
          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              <%= booking.status %>
            </button>
            <ul class="dropdown-menu">
              <% Booking.statuses.keys.each do |status| %>
                <li>
                  <%= link_to status,
                              booking_path(booking, booking: {status: status}),
                              class: 'dropdown-item',
                              data: {
                                turbo_method: :patch
                              } %>
                </li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <% can_delete = false if booking.confirmed? && booking.date < Date.today %>

    <% end %>
  </ul>
    <% if can_delete %>
        <%= link_to "Delete", meal_path(meal), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"}, class: "btn btn-primary" %>
    <% end %>
</div>
